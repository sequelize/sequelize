function FileWriter(e){var t=this;if(!(t instanceof FileWriter))throw new Error("FileWriter must be called as constructor.");if(e.type!=="File"||!e.File)throw new Error("Non-file type "+e.type);t._buffer=[],t._bytesWritten=0,Writer.call(this,e)}module.exports=FileWriter;var fs=require("../../graceful-fs/graceful-fs.js"),mkdir=require("../../mkdirp"),Writer=require("./writer.js"),inherits=require("../../inherits/inherits.js"),EOF={};inherits(FileWriter,Writer),FileWriter.prototype._create=function(){var e=this;if(e._stream)return;var t={};e.props.flags&&(t.flags=e.props.flags),t.mode=Writer.filemode,e._old&&e._old.blksize&&(t.bufferSize=e._old.blksize),e._stream=fs.createWriteStream(e._path,t),e._stream.on("open",function(t){e.ready=!0,e._buffer.forEach(function(t){t===EOF?e._stream.end():e._stream.write(t)}),e.emit("ready")}),e._stream.on("drain",function(){e.emit("drain")}),e._stream.on("close",function(){e._finish()})},FileWriter.prototype.write=function(e){var t=this;t._bytesWritten+=e.length;if(!t.ready)return t._buffer.push(e),!1;var n=t._stream.write(e);return n||t._stream._queue&&t._stream._queue.length<=2},FileWriter.prototype.end=function(e){var t=this;return e&&t.write(e),t.ready?t._stream.end():(t._buffer.push(EOF),!1)},FileWriter.prototype._finish=function(){var e=this;typeof e.size=="number"&&e._bytesWritten!=e.size&&e.error("Did not get expected byte count.\nexpect: "+e.size+"\n"+"actual: "+e._bytesWritten),Writer.prototype._finish.call(e)};