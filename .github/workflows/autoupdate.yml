name: auto-update PRs
on:
  push: {}
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true
jobs:
  autoupdate:
    # restrict the review events that trigger this workflow as all review replies count as pull_request_review
    if: ${{ !github.event.review || (github.event.review.state == 'APPROVED' || github.event.review.state == 'DISMISSED') }}
    runs-on: ubuntu-latest
    steps:
      - uses: docker://chinthakagodawita/autoupdate-action:v1
        env:
          GITHUB_TOKEN: '${{ secrets.AUTOMERGE_PAT }}'
          PR_FILTER: 'auto_merge'
          PR_READY_STATE: 'ready_for_review'
          MERGE_CONFLICT_ACTION: 'fail'
